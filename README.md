# SharePoint custom claims provider using the local farm's User Profile Service as the users data source
This solution can be used in Extranet/Partners Portal SharePoint deployment scenarios. One example of such scenario is when SharePoint farm deployed in DMZ in an isolated external Active Directory forest is configured for authentication of internal users having account in the primary AD forest via ADFS/SAML. In this case, when SAML authentication provider is used, SharePoint People Picker control does not perform account search and resolution, unless a custom claims provider is deployed to provide required data on SAML users to PeoplePicker. This implementation of the custom claims provider works by querying the local UPS service for user information, which is supposed to have profiles for the users accounts from the internal Active Directory. How profiles are created in the local UPS is not important for proper functioning of the UPSClaimProvider, as long as such fields as "Display Name" and "Work Email" are filled in each profile, but I can recommend to use the accompanying tool [UPSBrowser](https://github.com/imatviyenko/UPSBrowser) to import user profiles from the internal AD or create them manually.
